Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.getBufferPositionFromMouseEvent = getBufferPositionFromMouseEvent;
exports.mouseEventNearPosition = mouseEventNearPosition;
exports.hasParent = hasParent;

var TOOLTIP_WIDTH_HIDE_OFFSET = 30;

function getBufferPositionFromMouseEvent(event, editor, editorElement) {
  var pixelPosition = editorElement.component.pixelPositionForMouseEvent(event);
  var screenPosition = editorElement.component.screenPositionForPixelPosition(pixelPosition);
  if (Number.isNaN(screenPosition.row) || Number.isNaN(screenPosition.column)) return null;
  // ^ Workaround for NaN bug steelbrain/linter-ui-default#191
  var expectedPixelPosition = editorElement.pixelPositionForScreenPosition(screenPosition);
  var differenceTop = pixelPosition.top - expectedPixelPosition.top;
  var differenceLeft = pixelPosition.left - expectedPixelPosition.left;
  // Only allow offset of 20px - Fixes steelbrain/linter-ui-default#63
  if ((differenceTop === 0 || differenceTop > 0 && differenceTop < 20 || differenceTop < 0 && differenceTop > -20) && (differenceLeft === 0 || differenceLeft > 0 && differenceLeft < 20 || differenceLeft < 0 && differenceLeft > -20)) {
    return editor.bufferPositionForScreenPosition(screenPosition);
  }
  return null;
}

function mouseEventNearPosition(_ref) {
  var event = _ref.event;
  var editor = _ref.editor;
  var editorElement = _ref.editorElement;
  var tooltipElement = _ref.tooltipElement;
  var screenPosition = _ref.screenPosition;

  var pixelPosition = editorElement.component.pixelPositionForMouseEvent(event);
  var expectedPixelPosition = editorElement.pixelPositionForScreenPosition(screenPosition);
  var differenceTop = pixelPosition.top - expectedPixelPosition.top;
  var differenceLeft = pixelPosition.left - expectedPixelPosition.left;

  var editorLineHeight = editor.lineHeightInPixels;
  var elementHeight = tooltipElement.offsetHeight + editorLineHeight;
  var elementWidth = tooltipElement.offsetWidth;

  if (differenceTop > 0) {
    // Cursor is below the line
    if (differenceTop > elementHeight + 1.5 * editorLineHeight) {
      return false;
    }
  } else if (differenceTop < 0) {
    // Cursor is above the line
    if (differenceTop < -1.5 * editorLineHeight) {
      return false;
    }
  }
  if (differenceLeft > 0) {
    // Right of the start of highlight
    if (differenceLeft > elementWidth + TOOLTIP_WIDTH_HIDE_OFFSET) {
      return false;
    }
  } else if (differenceLeft < 0) {
    // Left of start of highlight
    if (differenceLeft < -1 * TOOLTIP_WIDTH_HIDE_OFFSET) {
      return false;
    }
  }
  return true;
}

function hasParent(givenElement, selector) {
  var element = givenElement;
  do {
    if (element.matches(selector)) {
      return true;
    }
    element = element.parentElement;
  } while (element && element.nodeName !== 'HTML');
  return false;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9ldmFuaGVuZHJpeDEvLmF0b20vcGFja2FnZXMvbGludGVyLXVpLWRlZmF1bHQvbGliL2VkaXRvci9oZWxwZXJzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFJQSxJQUFNLHlCQUF5QixHQUFHLEVBQUUsQ0FBQTs7QUFFN0IsU0FBUywrQkFBK0IsQ0FBQyxLQUFpQixFQUFFLE1BQWtCLEVBQUUsYUFBcUIsRUFBVTtBQUNwSCxNQUFNLGFBQWEsR0FBRyxhQUFhLENBQUMsU0FBUyxDQUFDLDBCQUEwQixDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQy9FLE1BQU0sY0FBYyxHQUFHLGFBQWEsQ0FBQyxTQUFTLENBQUMsOEJBQThCLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDNUYsTUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsRUFBRSxPQUFPLElBQUksQ0FBQTs7QUFFeEYsTUFBTSxxQkFBcUIsR0FBRyxhQUFhLENBQUMsOEJBQThCLENBQUMsY0FBYyxDQUFDLENBQUE7QUFDMUYsTUFBTSxhQUFhLEdBQUcsYUFBYSxDQUFDLEdBQUcsR0FBRyxxQkFBcUIsQ0FBQyxHQUFHLENBQUE7QUFDbkUsTUFBTSxjQUFjLEdBQUcsYUFBYSxDQUFDLElBQUksR0FBRyxxQkFBcUIsQ0FBQyxJQUFJLENBQUE7O0FBRXRFLE1BQ0UsQ0FBQyxhQUFhLEtBQUssQ0FBQyxJQUFLLGFBQWEsR0FBRyxDQUFDLElBQUksYUFBYSxHQUFHLEVBQUUsQUFBQyxJQUFLLGFBQWEsR0FBRyxDQUFDLElBQUksYUFBYSxHQUFHLENBQUMsRUFBRSxDQUFDLEtBQzlHLGNBQWMsS0FBSyxDQUFDLElBQUssY0FBYyxHQUFHLENBQUMsSUFBSSxjQUFjLEdBQUcsRUFBRSxBQUFDLElBQUssY0FBYyxHQUFHLENBQUMsSUFBSSxjQUFjLEdBQUcsQ0FBQyxFQUFFLENBQUMsQUFBQyxFQUNySDtBQUNBLFdBQU8sTUFBTSxDQUFDLCtCQUErQixDQUFDLGNBQWMsQ0FBQyxDQUFBO0dBQzlEO0FBQ0QsU0FBTyxJQUFJLENBQUE7Q0FDWjs7QUFFTSxTQUFTLHNCQUFzQixDQUFDLElBQXdFLEVBQVc7TUFBakYsS0FBSyxHQUFQLElBQXdFLENBQXRFLEtBQUs7TUFBRSxNQUFNLEdBQWYsSUFBd0UsQ0FBL0QsTUFBTTtNQUFFLGFBQWEsR0FBOUIsSUFBd0UsQ0FBdkQsYUFBYTtNQUFFLGNBQWMsR0FBOUMsSUFBd0UsQ0FBeEMsY0FBYztNQUFFLGNBQWMsR0FBOUQsSUFBd0UsQ0FBeEIsY0FBYzs7QUFDbkcsTUFBTSxhQUFhLEdBQUcsYUFBYSxDQUFDLFNBQVMsQ0FBQywwQkFBMEIsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUMvRSxNQUFNLHFCQUFxQixHQUFHLGFBQWEsQ0FBQyw4QkFBOEIsQ0FBQyxjQUFjLENBQUMsQ0FBQTtBQUMxRixNQUFNLGFBQWEsR0FBRyxhQUFhLENBQUMsR0FBRyxHQUFHLHFCQUFxQixDQUFDLEdBQUcsQ0FBQTtBQUNuRSxNQUFNLGNBQWMsR0FBRyxhQUFhLENBQUMsSUFBSSxHQUFHLHFCQUFxQixDQUFDLElBQUksQ0FBQTs7QUFFdEUsTUFBTSxnQkFBZ0IsR0FBRyxNQUFNLENBQUMsa0JBQWtCLENBQUE7QUFDbEQsTUFBTSxhQUFhLEdBQUcsY0FBYyxDQUFDLFlBQVksR0FBRyxnQkFBZ0IsQ0FBQTtBQUNwRSxNQUFNLFlBQVksR0FBRyxjQUFjLENBQUMsV0FBVyxDQUFBOztBQUUvQyxNQUFJLGFBQWEsR0FBRyxDQUFDLEVBQUU7O0FBRXJCLFFBQUksYUFBYSxHQUFJLGFBQWEsR0FBSSxHQUFHLEdBQUcsZ0JBQWdCLEFBQUMsQUFBQyxFQUFFO0FBQzlELGFBQU8sS0FBSyxDQUFBO0tBQ2I7R0FDRixNQUFNLElBQUksYUFBYSxHQUFHLENBQUMsRUFBRTs7QUFFNUIsUUFBSSxhQUFhLEdBQUksQ0FBQyxHQUFHLEdBQUcsZ0JBQWdCLEFBQUMsRUFBRTtBQUM3QyxhQUFPLEtBQUssQ0FBQTtLQUNiO0dBQ0Y7QUFDRCxNQUFJLGNBQWMsR0FBRyxDQUFDLEVBQUU7O0FBRXRCLFFBQUksY0FBYyxHQUFJLFlBQVksR0FBRyx5QkFBeUIsQUFBQyxFQUFFO0FBQy9ELGFBQU8sS0FBSyxDQUFBO0tBQ2I7R0FDRixNQUFNLElBQUksY0FBYyxHQUFHLENBQUMsRUFBRTs7QUFFN0IsUUFBSSxjQUFjLEdBQUksQ0FBQyxDQUFDLEdBQUcseUJBQXlCLEFBQUMsRUFBRTtBQUNyRCxhQUFPLEtBQUssQ0FBQTtLQUNiO0dBQ0Y7QUFDRCxTQUFPLElBQUksQ0FBQTtDQUNaOztBQUVNLFNBQVMsU0FBUyxDQUFDLFlBQXlCLEVBQUUsUUFBZ0IsRUFBVztBQUM5RSxNQUFJLE9BQU8sR0FBRyxZQUFZLENBQUE7QUFDMUIsS0FBRztBQUNELFFBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsRUFBRTtBQUM3QixhQUFPLElBQUksQ0FBQTtLQUNaO0FBQ0QsV0FBTyxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUE7R0FDaEMsUUFBUSxPQUFPLElBQUksT0FBTyxDQUFDLFFBQVEsS0FBSyxNQUFNLEVBQUM7QUFDaEQsU0FBTyxLQUFLLENBQUE7Q0FDYiIsImZpbGUiOiIvVXNlcnMvZXZhbmhlbmRyaXgxLy5hdG9tL3BhY2thZ2VzL2xpbnRlci11aS1kZWZhdWx0L2xpYi9lZGl0b3IvaGVscGVycy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cbmltcG9ydCB0eXBlIHsgUG9pbnQsIFRleHRFZGl0b3IgfSBmcm9tICdhdG9tJ1xuXG5jb25zdCBUT09MVElQX1dJRFRIX0hJREVfT0ZGU0VUID0gMzBcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJ1ZmZlclBvc2l0aW9uRnJvbU1vdXNlRXZlbnQoZXZlbnQ6IE1vdXNlRXZlbnQsIGVkaXRvcjogVGV4dEVkaXRvciwgZWRpdG9yRWxlbWVudDogT2JqZWN0KTogP1BvaW50IHtcbiAgY29uc3QgcGl4ZWxQb3NpdGlvbiA9IGVkaXRvckVsZW1lbnQuY29tcG9uZW50LnBpeGVsUG9zaXRpb25Gb3JNb3VzZUV2ZW50KGV2ZW50KVxuICBjb25zdCBzY3JlZW5Qb3NpdGlvbiA9IGVkaXRvckVsZW1lbnQuY29tcG9uZW50LnNjcmVlblBvc2l0aW9uRm9yUGl4ZWxQb3NpdGlvbihwaXhlbFBvc2l0aW9uKVxuICBpZiAoTnVtYmVyLmlzTmFOKHNjcmVlblBvc2l0aW9uLnJvdykgfHwgTnVtYmVyLmlzTmFOKHNjcmVlblBvc2l0aW9uLmNvbHVtbikpIHJldHVybiBudWxsXG4gIC8vIF4gV29ya2Fyb3VuZCBmb3IgTmFOIGJ1ZyBzdGVlbGJyYWluL2xpbnRlci11aS1kZWZhdWx0IzE5MVxuICBjb25zdCBleHBlY3RlZFBpeGVsUG9zaXRpb24gPSBlZGl0b3JFbGVtZW50LnBpeGVsUG9zaXRpb25Gb3JTY3JlZW5Qb3NpdGlvbihzY3JlZW5Qb3NpdGlvbilcbiAgY29uc3QgZGlmZmVyZW5jZVRvcCA9IHBpeGVsUG9zaXRpb24udG9wIC0gZXhwZWN0ZWRQaXhlbFBvc2l0aW9uLnRvcFxuICBjb25zdCBkaWZmZXJlbmNlTGVmdCA9IHBpeGVsUG9zaXRpb24ubGVmdCAtIGV4cGVjdGVkUGl4ZWxQb3NpdGlvbi5sZWZ0XG4gIC8vIE9ubHkgYWxsb3cgb2Zmc2V0IG9mIDIwcHggLSBGaXhlcyBzdGVlbGJyYWluL2xpbnRlci11aS1kZWZhdWx0IzYzXG4gIGlmIChcbiAgICAoZGlmZmVyZW5jZVRvcCA9PT0gMCB8fCAoZGlmZmVyZW5jZVRvcCA+IDAgJiYgZGlmZmVyZW5jZVRvcCA8IDIwKSB8fCAoZGlmZmVyZW5jZVRvcCA8IDAgJiYgZGlmZmVyZW5jZVRvcCA+IC0yMCkpICYmXG4gICAgKGRpZmZlcmVuY2VMZWZ0ID09PSAwIHx8IChkaWZmZXJlbmNlTGVmdCA+IDAgJiYgZGlmZmVyZW5jZUxlZnQgPCAyMCkgfHwgKGRpZmZlcmVuY2VMZWZ0IDwgMCAmJiBkaWZmZXJlbmNlTGVmdCA+IC0yMCkpXG4gICkge1xuICAgIHJldHVybiBlZGl0b3IuYnVmZmVyUG9zaXRpb25Gb3JTY3JlZW5Qb3NpdGlvbihzY3JlZW5Qb3NpdGlvbilcbiAgfVxuICByZXR1cm4gbnVsbFxufVxuXG5leHBvcnQgZnVuY3Rpb24gbW91c2VFdmVudE5lYXJQb3NpdGlvbih7IGV2ZW50LCBlZGl0b3IsIGVkaXRvckVsZW1lbnQsIHRvb2x0aXBFbGVtZW50LCBzY3JlZW5Qb3NpdGlvbiB9OiBPYmplY3QpOiBib29sZWFuIHtcbiAgY29uc3QgcGl4ZWxQb3NpdGlvbiA9IGVkaXRvckVsZW1lbnQuY29tcG9uZW50LnBpeGVsUG9zaXRpb25Gb3JNb3VzZUV2ZW50KGV2ZW50KVxuICBjb25zdCBleHBlY3RlZFBpeGVsUG9zaXRpb24gPSBlZGl0b3JFbGVtZW50LnBpeGVsUG9zaXRpb25Gb3JTY3JlZW5Qb3NpdGlvbihzY3JlZW5Qb3NpdGlvbilcbiAgY29uc3QgZGlmZmVyZW5jZVRvcCA9IHBpeGVsUG9zaXRpb24udG9wIC0gZXhwZWN0ZWRQaXhlbFBvc2l0aW9uLnRvcFxuICBjb25zdCBkaWZmZXJlbmNlTGVmdCA9IHBpeGVsUG9zaXRpb24ubGVmdCAtIGV4cGVjdGVkUGl4ZWxQb3NpdGlvbi5sZWZ0XG5cbiAgY29uc3QgZWRpdG9yTGluZUhlaWdodCA9IGVkaXRvci5saW5lSGVpZ2h0SW5QaXhlbHNcbiAgY29uc3QgZWxlbWVudEhlaWdodCA9IHRvb2x0aXBFbGVtZW50Lm9mZnNldEhlaWdodCArIGVkaXRvckxpbmVIZWlnaHRcbiAgY29uc3QgZWxlbWVudFdpZHRoID0gdG9vbHRpcEVsZW1lbnQub2Zmc2V0V2lkdGhcblxuICBpZiAoZGlmZmVyZW5jZVRvcCA+IDApIHtcbiAgICAvLyBDdXJzb3IgaXMgYmVsb3cgdGhlIGxpbmVcbiAgICBpZiAoZGlmZmVyZW5jZVRvcCA+IChlbGVtZW50SGVpZ2h0ICsgKDEuNSAqIGVkaXRvckxpbmVIZWlnaHQpKSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9IGVsc2UgaWYgKGRpZmZlcmVuY2VUb3AgPCAwKSB7XG4gICAgLy8gQ3Vyc29yIGlzIGFib3ZlIHRoZSBsaW5lXG4gICAgaWYgKGRpZmZlcmVuY2VUb3AgPCAoLTEuNSAqIGVkaXRvckxpbmVIZWlnaHQpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cbiAgaWYgKGRpZmZlcmVuY2VMZWZ0ID4gMCkge1xuICAgIC8vIFJpZ2h0IG9mIHRoZSBzdGFydCBvZiBoaWdobGlnaHRcbiAgICBpZiAoZGlmZmVyZW5jZUxlZnQgPiAoZWxlbWVudFdpZHRoICsgVE9PTFRJUF9XSURUSF9ISURFX09GRlNFVCkpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfSBlbHNlIGlmIChkaWZmZXJlbmNlTGVmdCA8IDApIHtcbiAgICAvLyBMZWZ0IG9mIHN0YXJ0IG9mIGhpZ2hsaWdodFxuICAgIGlmIChkaWZmZXJlbmNlTGVmdCA8ICgtMSAqIFRPT0xUSVBfV0lEVEhfSElERV9PRkZTRVQpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1BhcmVudChnaXZlbkVsZW1lbnQ6IEhUTUxFbGVtZW50LCBzZWxlY3Rvcjogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGxldCBlbGVtZW50ID0gZ2l2ZW5FbGVtZW50XG4gIGRvIHtcbiAgICBpZiAoZWxlbWVudC5tYXRjaGVzKHNlbGVjdG9yKSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudFxuICB9IHdoaWxlIChlbGVtZW50ICYmIGVsZW1lbnQubm9kZU5hbWUgIT09ICdIVE1MJylcbiAgcmV0dXJuIGZhbHNlXG59XG4iXX0=